# Домашнее задание к занятию "13.Системы мониторинга" Вахрамеев А.В.

1. #### Минимальный набор метрик для мониторинга
   Использование ЦПУ (CPU Usage) - Поскольку вычисления загружают ЦПУ, важно отслеживать нагрузку на процессор.
   Использование оперативной памяти (RAM Usage) - Чтобы контролировать, сколько памяти потребляет приложение.
   Использование дискового пространства (Disk Usage) - Так как отчеты сохраняются на диск, необходимо следить за доступным местом.
   Состояние сетевой активности (Network Activity) - Важно мониторить, поскольку взаимодействие с платформой осуществляется через HTTP.
   Число одновременных HTTP-соединений (Concurrent HTTP Connections) - Для понимания нагрузки на сервер.

2. #### Объяснение менеджеру продукта
   ##### Упрощенное объяснение метрик 

   RAM - Это как объем памяти у компьютера, важно, чтобы он не был переполнен.

   Inodes - Это как адреса, по которым хранится информация на диске, важно следить, чтобы у нас было достаточно адресов для сохранения данных.

   CPU_load - Это как загруженность работников, если они перегружены, работа замедляется.

   #### Метрики для понимания качества обслуживания

   Время отклика системы - Как быстро система отвечает на запросы пользователей.

   Процент успешных запросов - Как часто наши услуги работают без ошибок.

   Время доступности системы (uptime) - Как долго наша система работает без перерывов.

3. #### Решение для DevOps команды без финансирования на сбор логов
   Использование открытого ПО для сбора логов ELK Stack (Elasticsearch, Logstash, Kibana) или Graylog.
   Локальное хранение и анализ логов ( анализа логов непосредственно на серверах).
     

4. #### Проблема с мониторингом SLA
   Возможно, формула не учитывает некоторые успешные запросы.
   Отсутствие 5xx и 4xx кодов не означает отсутствие других проблем, например, проблем с сетью или таймауты.

6. #### Плюсы и минусы pull и push систем мониторинга
   Pull-системы (например, Prometheus)
   Плюсы: Централизованное управление конфигурацией, более безопасно (агенты не нуждаются в доступе к сети).
   Минусы: Сложности с мониторингом временных и динамических ресурсов.

   Push-системы (например, Zabbix с использованием Zabbix Sender)
   Плюсы: Гибкость в отправке данных, хорошо подходит для динамических и распределенных систем.
   Минусы: Более сложное управление безопасностью, может потребоваться дополнительная настройка сетевых правил.

7. #### Системы мониторинга по моделям
   ##### Push модель
   
   TICK
   
   Zabbix (может работать и в push, и в pull режимах)
   
   VictoriaMetrics (поддерживает и push, и pull)
   
   Nagios (использует пассивные проверки, которые можно считать аналогом push-модели, и активные проверки, соответствующие pull-модели).

   ##### Pull модель
   
   Prometheus



9. Склонируйте себе [репозиторий](https://github.com/influxdata/sandbox/tree/master) и запустите TICK-стэк, 
используя технологии docker и docker-compose.

В виде решения на это упражнение приведите скриншот веб-интерфейса ПО chronograf (`http://localhost:8888`). 

P.S.: если при запуске некоторые контейнеры будут падать с ошибкой - проставьте им режим `Z`, например
`./data:/var/lib:Z`


![Screenshot from 2024-01-08 14-08-46](https://github.com/alexnet123/homeworks/assets/75438030/ceb98495-ab45-4a8a-904b-ca4b2f76fe29)


9. Перейдите в веб-интерфейс Chronograf (http://localhost:8888) и откройте вкладку Data explorer.
        
    - Нажмите на кнопку Add a query
    - Изучите вывод интерфейса и выберите БД telegraf.autogen
    - В `measurments` выберите cpu->host->telegraf-getting-started, а в `fields` выберите usage_system. Внизу появится график утилизации cpu.
    - Вверху вы можете увидеть запрос, аналогичный SQL-синтаксису. Поэкспериментируйте с запросом, попробуйте изменить группировку и интервал наблюдений.

![Screenshot from 2024-01-08 14-20-16](https://github.com/alexnet123/homeworks/assets/75438030/90452b29-4dd2-49fa-98b3-1160bf764b0f)


10. Изучите список [telegraf inputs](https://github.com/influxdata/telegraf/tree/master/plugins/inputs). 
Добавьте в конфигурацию telegraf следующий плагин - [docker](https://github.com/influxdata/telegraf/tree/master/plugins/inputs/docker):
```
[[inputs.docker]]
  endpoint = "unix:///var/run/docker.sock"
```

Дополнительно вам может потребоваться донастройка контейнера telegraf в `docker-compose.yml` дополнительного volume и 
режима privileged:
```
  telegraf:
    image: telegraf:1.4.0
    privileged: true
    volumes:
      - ./etc/telegraf.conf:/etc/telegraf/telegraf.conf:Z
      - /var/run/docker.sock:/var/run/docker.sock:Z
    links:
      - influxdb
    ports:
      - "8092:8092/udp"
      - "8094:8094"
      - "8125:8125/udp"
```

После настройке перезапустите telegraf, обновите веб интерфейс и приведите скриншотом список `measurments` в 
веб-интерфейсе базы telegraf.autogen . Там должны появиться метрики, связанные с docker.

![Screenshot from 2024-01-08 16-15-37](https://github.com/alexnet123/homeworks/assets/75438030/d325924c-4f87-4108-8388-c9fe8f0fffc0)


