# Домашнее задание к занятию 5. «Оркестрация кластером Docker контейнеров на примере Docker Swarm» Вахрамеев А.В.


## Задача 1

Дайте письменые ответы на вопросы:

- В чём отличие режимов работы сервисов в Docker Swarm-кластере: replication и global?

Режим репликации (replication): В этом режиме сервис запускается в виде заданного количества реплик, которые распределяются по различным узлам кластера. Количество реплик задается в конфигурации сервиса, и Swarm-менеджер автоматически управляет их масштабированием и поддержанием желаемого количества реплик. Режим репликации обеспечивает высокую доступность и отказоустойчивость сервиса.

Режим глобального развертывания (global): В этом режиме каждый узел в кластере запускает по одной реплике сервиса. То есть каждый узел кластера будет иметь полный набор экземпляров сервиса. Режим глобального развертывания обычно используется для сервисов, где требуется наличие экземпляра на каждом узле, например, для сервисов сети или системных сервисов.

- Какой алгоритм выбора лидера используется в Docker Swarm-кластере?

В Docker Swarm используется алгоритм распределенного консенсуса Raft для выбора лидера. Алгоритм Raft гарантирует, что в кластере будет выбран только один активный лидер, который будет отвечать за принятие решений и координацию действий в кластере. В случае отказа текущего лидера, алгоритм Raft автоматически выбирает нового лидера из доступных участников кластера.
Если обычный узел долго не получает сообщений от лидера, то он переходит в состояние «кандидат» и посылает другим узлам запрос на голосование. Другие узлы голосуют за того кандидата, от которого они получили первый запрос. Если кандидат получает сообщение от лидера, то он снимает свою кандидатуру и возвращается в обычное состояние. Если кандидат получает большинство голосов, то он становится лидером. Если же он не получил большинства (это случай, когда на кластере возникли сразу несколько кандидатов и голоса разделились), то кандидат ждёт случайное время и инициирует новую процедуру голосования.

Процедура голосования повторяется, пока не будет выбран лидер.

- Что такое Overlay Network?

Overlay Network в Docker Swarm является абстрактным виртуальным сетевым слоем, который позволяет связывать контейнеры, работающие на разных узлах кластера, таким образом, что они могут общаться между собой, как будто находятся в одной локальной сети. Примерами оверлеев являются сети VPN, построенные поверх другой сети. 


## Задача 2

Создайте ваш первый Docker Swarm-кластер в Яндекс Облаке.

Чтобы получить зачёт, предоставьте скриншот из терминала (консоли) с выводом команды:
```
docker node ls
```

![Снимок экрана от 2023-05-30 21-06-49](https://github.com/alexnet123/homeworks/assets/75438030/c1bf4a26-9ab3-4541-81bb-d1feac6c1900)


## Задача 3

Создайте ваш первый, готовый к боевой эксплуатации кластер мониторинга, состоящий из стека микросервисов.

Чтобы получить зачёт, предоставьте скриншот из терминала (консоли), с выводом команды:
```
docker service ls
```

![Снимок экрана от 2023-05-30 21-07-20](https://github.com/alexnet123/homeworks/assets/75438030/f8285302-5c65-4ff5-a01d-187607c664c0)


## Задача 4 (*)

Выполните на лидере Docker Swarm-кластера команду, указанную ниже, и дайте письменное описание её функционала — что она делает и зачем нужна:
```
# см.документацию: https://docs.docker.com/engine/swarm/swarm_manager_locking/
docker swarm update --autolock=true
```

![Снимок экрана от 2023-05-30 21-24-42](https://github.com/alexnet123/homeworks/assets/75438030/537f17c2-ea45-4065-947b-e34f235a7cda)

Команда docker swarm update --autolock=true выполняется на лидере Docker Swarm-кластера и используется для включения функции автоматической блокировки (autolock) менеджера кластера.
Функция автоматической блокировки (autolock) предназначена для повышения безопасности кластера Docker Swarm. Когда функция включена, менеджер кластера будет автоматически блокироваться при перезапуске. Для разблокировки менеджера требуется ввод соответствующего ключа.
